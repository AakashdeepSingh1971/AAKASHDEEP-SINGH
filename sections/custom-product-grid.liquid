<div class="section2">
  <h1>Tisso vison in the wild</h1>
  <div class="productGrid">
    {% assign products = collections.all.products %}

    {% for product in products limit: 6 %}
      <div class="productItem">
        {{ product | image_url: width: 433 | image_tag: width: 433 }}
        <button
          class="open-popup"
          onclick="fetchProduct({{ product.id }})"
          data-product-id="{{ product.id }}"
        >
          +
        </button>
      </div>
    {% endfor %}
  </div>

  <div class="popup" id="product-popup">
    <div class="popup-content">
      <span class="close-popup" onclick="closePopup()">X</span>
      <div
        class="popupMainDiv"
        style="
          height: 90%;
          justify-content: space-between;
        "
      >
        <div class="popupMainDiv">
          <div class="firstDiv">
            <img id="popupImg" src="" alt="Product Image" class="productImage" height="140" width="120">
            <div class="popupTextDiv">
              <h2 id="popup-title"></h2>
              <p id="popup-price"></p>
              <p id="popup-description"></p>
            </div>
          </div>
          <div class="secondDiv">
            <div class="color-selector">
              <h2>Color</h2>
              <div class="color-button-group">
                <div class="color-option" data-color="White">
                  <span class="colorDiv" style="background-color:#fff;"></span>
                  <span class="colorType">White</span>
                </div>
                <div class="divider"></div>
                <div class="color-option" data-color="Black">
                  <span class="colorDiv" style="background-color:#000;"></span> <span class="colorType">Black</span>
                </div>
              </div>

              <div class="size-selector">
                <label>Size</label>
                <select id="size-options" class="size-options">
                  <option disabled selected>Choose your size</option>
                </select>
              </div>
            </div>
          </div>
        </div>
        <button id="add-to-cart" class="add-to-cart-button">ADD TO CART</button>
      </div>
    </div>
  </div>
</div>
<style>
   .secondDiv .buttonDiv {
     display: inline-flex;
     align-items: center;
     padding: 10px 20px;
     background-color: #3498db;
     border-radius: 5px;
     cursor: pointer;
     transition: background-color 0.6s ease, box-shadow 0.6s ease;
     overflow: hidden;
     position: relative;
     box-shadow: none;
  }

  .secondDiv .buttonDiv a {
     color: #fff;
     text-decoration: none;
     font-size: 18px;
     margin-right: 10px;
     position: relative;
     z-index: 1;
     transition: transform 0.6s cubic-bezier(0.25, 0.8, 0.25, 1);
  }


  .secondDiv .customHeaderImage {
     position: relative;
     z-index: 1;
     transition: transform 0.6s cubic-bezier(0.25, 0.8, 0.25, 1);
  }


  .secondDiv .buttonDiv:hover {
     background-color: #2ecc71;
     box-shadow: 0px 8px 15px rgba(0, 0, 0, 0.3);


  .secondDiv .buttonDiv:hover a {
     transform: translateX(10px);
  }


  .secondDiv .buttonDiv:hover .customHeaderImage {
     transform: translateX(10px);
  }
    .close-popup{
          display: flex;
      justify-content: flex-end;
    }
        .popup p{
          margin:0;
        }
      .popup-content{
        width: 311px;
    height: 447px;

      }
        .popupMainDiv{
          display:flex;
          flex-direction:column;
          gap:10px;

        }
        .firstDiv{
          gap:10px;
          display:flex;
        }
        .popupTextDiv{
          display:flex;
          flex-direction:column;
          gap:15px;
        }
        #popup-title{
          font-family: Jost;
      font-size: 16px;
      font-weight: 300;
      line-height: 19.2px;
      text-align: left;

        }
        #popup-price{
          font-family: Lustria;
      font-size: 16px;
      font-weight: 400;
      line-height: 19.2px;
      text-align: left;

        }
        #popup-description>p{
          font-family: Jost;
      font-size: 14px;
      font-weight: 300;
      line-height: 15.4px;
      letter-spacing: -0.01em;
      text-align: left;

        }
        .section2 {
          padding: 51px;
        }
        .productGrid {
          display: grid;
          grid-template-columns: repeat(3, 1fr);
          gap: 20px;
        }
        .gridItem {
          width: 433px;
          height: 444px;

        }
        .popup {
          display: none;
          position: fixed;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          background-color: rgba(0, 0, 0, 0.5);

        }
        .popup-content {
          background-color: #fff;
          margin: 10% auto;
          padding: 20px;

          width: 311px;Ï
          height: 447px;

          gap: 0;

          background: rgba(255, 255, 255, 1);
          box-shadow: 0 2px 4px 0 rgba(0, 0, 0, 0.2);

        }
</style>

<script>
    const productData = [
      {% for product in products %}{
      'id': "{{ product.id }}",
      'title':"{{ product.title }}",
      'price' : "{{ product.price  }}",
      'description':"{{ product.description }}",
      'image':"{{ product.featured_image | img_url: '300x300' }}",
      'variants':[
        {% for variant in product.variants %}
          {
            'id':"{{ variant.id }}",
            'option1':"{{ variant.option1 }}",
            'option2':"{{ variant.option2 }}",
            'price':"{{ variant.price }}",
          }
            {% if forloop.last==false %},{% endif %}
            {% endfor %}
          ]
        }
            {% if forloop.last==false %},{% endif %}
            {% endfor %}
        ]
            console.log(productData)


    const popup = document.getElementById("product-popup");

    function closePopup() {

      popup.style.display = "none";
    };

    let currentProduct = null;

   function fetchProduct(productId){
    console.log(productId)
      const id = productId.toString();
   console.log(id)
      const product = productData.find(item => item.id === id);

      if (product) {
        console.log(product)


      document.getElementById('popupImg').src = product.image;
    document.getElementById('popup-title').textContent = product.title;

    document.getElementById('popup-price').textContent = product.price+"€"|| '';
    document.getElementById('popup-description').innerHTML = product.description || '';

    // const colorOptions = document.getElementById('color-options');
    // const sizeOptions = document.getElementById('size-options');
    // colorOptions.innerHTML = '';
    // sizeOptions.innerHTML = '';

    // let colors = new Set();
    // let sizes = new Set();

    // product.variants.forEach(variant => {
    //   if (variant.option2) colors.add(variant.option2);
    //   if (variant.option1) sizes.add(variant.option1);
    // });

    // colors.forEach(color => {
    //   const colorBtn = document.createElement('button');
    //   colorBtn.classList.add('color-option');
    //   colorBtn.textContent = color;
    //   colorBtn.setAttribute('data-color', color);
    //   colorBtn.onclick = function() {
    //     document.querySelectorAll('.color-option').forEach(btn => btn.classList.remove('active'));
    //     colorBtn.classList.add('active');
    //   };
    //   colorOptions.appendChild(colorBtn);
    // });

    // sizes.forEach(size => {
    //   const sizeOption = document.createElement('option');
    //   sizeOption.value = size;
    //   sizeOption.textContent = size;
    //   sizeOptions.appendChild(sizeOption);
    // });

    document.getElementById('product-popup').style.display = 'flex';
            } else {
        console.error('Product not found!');
      }
  }

  document.querySelector('.close-popup').addEventListener('click', () => {
    document.getElementById('product-popup').style.display = 'none';
  });
</script>
